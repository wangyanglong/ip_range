import json

aliyun_ips = """
42.120.0.0 - 42.121.255.255,   
110.75.160.0 - 110.75.191.255,   
112.74.0.0 - 112.74.255.255,   
120.24.0.0 - 120.27.255.255,   
121.40.0.0 - 121.43.255.255,   
182.92.0.0 - 182.92.255.255,   
223.4.0.0 - 223.7.255.255,   
42.96.128.0 - 42.96.255.255,   
218.244.128.0 - 218.244.159.255,   
115.28.0.0 - 115.29.255.255,   
121.196.0.0 - 121.199.255.255,   
112.124.0.0 - 112.127.255.255,   
114.215.0.0 - 114.215.255.255,   
123.56.0.0 - 123.57.255.255,   
101.200.0.0 - 101.201.255.255,   
139.196.0.0 - 139.196.255.255,   
118.178.0.0 - 118.178.255.255,   
101.132.0.0 - 101.133.255.255,   
118.31.0.0 - 118.31.255.255,   
121.89.0.0 - 121.89.255.255,   
139.224.0.0 - 139.224.255.255,   
118.190.0.0 - 118.190.255.255,   
139.129.0.0 - 139.129.255.255,   
203.119.128.0 - 203.119.255.255,   
120.55.0.0 - 120.55.255.255,   
120.76.0.0 - 120.79.255.255,   
60.205.0.0 - 60.205.255.255,   
119.23.0.0 - 119.23.255.255,   
114.55.0.0 - 114.55.255.255,   
106.14.0.0 - 106.15.255.255,   
59.110.0.0 - 59.110.255.255,   
39.96.0.0 - 39.108.255.255,   
116.62.0.0 - 116.62.255.255,   
47.104.0.0 - 47.111.255.255,   
101.37.0.0 - 101.37.255.255,   
47.113.0.0 - 47.127.255.255,   
47.98.0.0 - 47.99.255.255,   
203.107.0.0 - 203.107.127.255,   
110.76.32.0 - 110.76.47.255,   
47.92.0.0 - 47.95.255.255,   
47.96.0.0 - 47.97.255.255,   
47.112.0.0 - 47.112.255.255,   
47.100.0.0 - 47.103.255.255,   
103.15.96.0 - 103.15.99.255
"""

tencent_ips = """
182.254.128.0 - 182.254.255.255,   
203.195.128.0 - 203.195.255.255,   
115.159.0.0 - 115.159.255.255,   
119.28.0.0 - 119.29.255.255,   
123.206.0.0 - 123.207.255.255,   
139.199.0.0 - 139.199.255.255,   
49.51.0.0 - 49.51.255.255,   
103.234.0.0 - 103.234.3.255,   
211.159.128.0 - 211.159.255.255,   
118.89.0.0 - 118.89.255.255,   
111.230.0.0 - 111.231.255.255,   
58.87.64.0 - 58.87.127.255,   
122.152.192.0 - 122.152.255.255,   
140.143.0.0 - 140.143.255.255,   
210.73.160.0 - 210.73.191.255,   
119.27.160.0 - 119.27.191.255,   
118.126.64.0 - 118.126.127.255
"""

huawei_ips = """
 127.0.0.0 - 127.255.255.255,   
 169.254.0.0 - 169.254.255.255,   
 100.64.0.0 - 100.127.255.255,   
 224.0.0.0 - 239.255.255.255,   
 198.51.100.0 - 198.51.100.255,   
 198.18.0.0 - 198.19.255.255,   
 240.0.0.0 - 255.255.255.255,   
 172.16.0.0 - 172.31.255.255,   
 10.0.0.0 - 10.255.255.255,   
 208.77.188.0 - 208.77.191.255,   
 199.43.132.0 - 199.43.135.255,   
 199.7.83.0 - 199.7.83.255,   
 199.253.182.0 - 199.253.183.255,   
 199.91.192.0 - 199.91.199.255,   
 199.4.138.0 - 199.4.138.255,   
 199.4.28.0 - 199.4.31.255,   
 217.0.0.0 - 217.255.255.255,   
 185.0.0.0 - 185.255.255.255,   
 5.0.0.0 - 5.255.255.255,   
 46.0.0.0 - 46.255.255.255,   
 151.0.0.0 - 151.255.255.255,   
 188.0.0.0 - 188.255.255.255,   
 176.0.0.0 - 176.255.255.255,   
 109.0.0.0 - 109.255.255.255,   
 192.0.0.0 - 192.255.255.255,   
 2.0.0.0 - 2.255.255.255,   
 62.0.0.0 - 62.255.255.255,   
 37.0.0.0 - 37.255.255.255,   
 178.0.0.0 - 178.255.255.255,   
 45.0.0.0 - 45.255.255.255,   
 31.0.0.0 - 31.255.255.255,   
 139.0.0.0 - 139.255.255.255,   
 160.0.0.0 - 160.255.255.255,   
 141.0.0.0 - 141.255.255.255,   
 152.0.0.0 - 152.255.255.255,   
 149.0.0.0 - 149.255.255.255
""" 

def parse_ips(ips_str,domain,control):
	rule_list=[]
	ips_str = ips_str.replace("\r","")
	ips_str = ips_str.replace("\n","")
	ip_list = ips_str.split(",")
	print "ip_list",len(ip_list)
	for i in range(len(ip_list)):
		print i
		ips = ip_list[i]
		k = ips.split("-")
		print k
		if k and len(k)>1:
			start_ip = k[0].strip()
			end_ip = k[1].strip()
			j = {"start_ip":start_ip,"end_ip":end_ip,"domain":domain,"control":control}
			rule_list.append(j)
	return rule_list
if __name__ == "__main__":
	t_ips = parse_ips(tencent_ips,"tencent",7)
	a_ips = parse_ips(aliyun_ips,"alyun",7)
	h_ips = parse_ips(huawei_ips,"huawei",7)

	rule_list = t_ips
	rule_list.extend(a_ips)
	rule_list.extend(h_ips)
	j_str = json.dumps({"rulelist":rule_list})
	print "rule:",j_str
	with open("rule.json","w") as f:
		f.write(j_str)